<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>审核</title>
    <link rel="shortcut icon" href="../../src/headtitle.png">
</head>
<body style="min-width: 1920px">

<div class="layui-layout layui-layout-admin">

    <!--头部导航-->
    <div id="top">
        <ul class="layui-header layui-nav" layfilter="">
            <li class="layui-nav-item" ><a href="home.html" style="font-family:'Arial Black';font-size: 20px">心情漂流瓶</a></li>
            <div class="layui-layout-right"><li class="layui-nav-item"><a href="javascript:;">欢迎光临！{{userName}}</a>
                <dl class="layui-nav-child">
                    <dd><a href="../logout.html">退出登录</a></dd>
                </dl>
            </li></div>
        </ul>
    </div>

    <div id="info" class="layui-body">

        <table class="layui-table">
            <colgroup>
                <col width="150">
                <col width="150">
                <col width="200">
                <col>
            </colgroup>
            <thead>
            <tr>
                <th>漂流瓶id</th>
                <th>类型</th>
                <th>时间</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>{{info.bottle_id}}</td>
                <td>{{info.type}}</td>
                <td>{{info.create_time}}</td>
            </tr>
            </tbody>
        </table>

        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 0px;margin-left: 0px" >
            <legend>内容审核</legend>
        </fieldset>
        <form class="layui-form">
            <div class="layui-form-item">
                <div class="layui-input-block" >
                    <p class="layui-input" style="width: 80%;height: 200px;font-size: large;padding: 10px">{{info.content}}</p>
                </div>
            </div>
        </form>
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 0px;margin-left: 0px" >
            <legend>回复</legend>
        </fieldset>
        <div class="layui-input-block" >
            <input type="text" v-model="reply" autocomplete="off" placeholder="回复" class="layui-input" style="width: 800px;min-height: 100px">
        </div>
        <div class="">
            <button class="layui-btn " style="margin-left: 400px" @click="past()">通过</button>
            <button class="layui-btn " style="margin-left: 400px;background-color: gray" @click="back()">驳回</button>
        </div>
    </div>

</div>
<script src="JS/vue.js"></script>
<script src="JS/axios.js"></script>
<script src="JS/bottle.js"></script>
<link href="layui/css/layui.css" rel="stylesheet">
<script src="layui/layui.js"></script>

<script>
    new Vue({
        el:"#info",
        data(){
            return{
                info:{},
                baseUrl:"https://mooddriftbottle.team",
                reply:""
            }
        },
        mounted: function () {
            const _this = this;
            axios({
                method: "post",
                url: baseUrl + "/bottle/get_random_bottle_unchecked",
                data: {}
            }).then(function (resp) {
                _this.info = resp.data;
            })
        },
        methods:{
            past:function (){
                let that = this;
                axios({
                    method:"post",
                    url: baseUrl + "/bottle/check",
                    data:{
                        "bottle_id":that.info.bottle_id,
                        "replyStr":that.reply,
                        "check":1
                    },
                    headers: { // 请求头
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                }).then(function (resp){
                    if(resp.data == "success"){
                        alert("审核结果提交成功")
                        location.reload();
                    }else{
                        alert("审核结果提交失败")
                    }
                })
            },
            back:function (){
                let that = this;
                axios({
                    method:"post",
                    url: baseUrl + "/bottle/check",
                    data:{
                        "bottle_id":that.info.bottle_id,
                        "check":2
                    },
                    headers: { // 请求头
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                }).then(function (resp){
                    if(resp.data == "success"){
                        alert("审核结果提交成功")
                        location.reload();
                    }else{
                        alert("审核结果提交失败")
                    }
                })
            }
        }
    })
</script>

</body>
</html>